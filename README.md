# 水墨画风格视频生成与异构时序一致性优化项目

## 1. 项目概述

本项目旨在解决当前AI视频生成领域的一大挑战：如何在保持特定艺术风格（中国水墨画）的同时，生成具有高度时序一致性的动态视频。传统方法生成的视频，尤其在艺术风格下，常出现闪烁、抖动和笔触断裂等问题。

为解决此问题，本项目引入了两大核心创新：

* **风格微调**：通过LoRA对基础模型进行微调，精确复现水墨画的独特美学。

* **异构时序一致性模块**：设计并训练了一个在扩散模型去噪**过程中**实时介入的`Temporal Module`，显著提升视频的帧间连贯性。

此外，为科学验证模块效果，我们搭建了一套完整的、自动化的四级对比评估流水线。

\[水墨画风格的飞龙动图\]

## 2. 核心创新

### 2.1. 水墨画风格微调 (Style Fine-tuning)

为了让模型掌握水墨画的核心视觉元素（如笔触、墨韵、留白、渗化效果），我们首先收集并整理了一个高质量的水墨画数据集。随后，我们使用 این 数据集对 `Wan-AI/Wan2.1-T2V-1.3B` 基础模型进行LoRA微调，产出了风格权重 `epoch-18.safetensors`。该权重成功地为模型注入了鲜明的水墨画风格，构成了后续所有实验的“风格基线”。

### 2.2. 异构时序一致性模块 (Heterogeneous Temporal Consistency)

这是本项目的核心技术创新。我们没有采用简单的后处理平滑，而是设计了一个直接集成在 `WanVideoPipeline` 去噪循环中的 `Temporal Module`。该模块在生成过程的每一步都对潜在向量进行校正，从而从根本上提升视频的稳定性。

该模块包含两大关键组件：

* **潜空间光流预测器 (Latent Flow Predictor)**：一个轻量级神经网络，用于预测相邻帧在紧凑潜空间中的运动向量（光流）。

* **Warping与Gating机制**：

  1. **Warping (扭曲)**: 利用预测的光流将前一帧的潜在向量“扭曲”对齐到当前帧。

  2. **Gating (门控融合)**: 通过一个可学习的Alpha参数，智能地判断在每个位置应该多大程度上相信“从上一帧扭曲来的信息”，多大程度上相信“当前帧新生成的信息”，实现信息的无缝融合。

我们采用**分阶段训练 (Staged Training)** 策略：首先在“重建预热”阶段让模型稳定收敛，然后在“时序训练”阶段引入`L_c`(内容连续性)、`L_m`(CLIP运动)、`L_e`(边缘一致性)等多维度时序损失，对`Temporal Module`、`Flow Predictor`以及`DiT`模型进行联合优化。

## 3. 量化评估体系

为了科学、严谨地验证我们的方法，我们搭建了一套自动化的四级对比评估流水线。

### 3.1. 四级对比实验 (Four-Level Comparison)

我们生成了四个级别的视频进行逐级对比，以清晰地剥离出每个模块的贡献：

| 级别 | 配置 | 回答的问题 | 
 | ----- | ----- | ----- | 
| **Level 0** | 基础模型 | “模型原始能力如何？” | 
| **Level 1** | 基础模型 + **水墨画LoRA** | “风格微调效果如何？” | 
| **Level 2** | 基础模型 + **联合训练后的DiT** | “联合训练是否在风格之外，也提升了DiT的内在稳定性？” | 
| **Level 3** | 基础模型 + **联合训练后的DiT** + **时序模块** | “时序模块带来了多大的额外稳定性提升？” | 

### 3.2. 定量评估指标

我们从**时序一致性**和**感知质量**两大维度对生成的132个视频（11个Prompt × 4个级别 × 3个Seed）进行了评估。

* **时序一致性指标**:

  * **tLPIPS (Temporal LPIPS)**: 衡量相邻帧的感知跳变程度。**越低越好**。

  * **Warping Error**: 评估光流预测的准确性。**越低越好**。

  * **Edge Consistency IoU**: 专为水墨画设计，衡量笔触边缘的重叠度与连贯性。**越高越好**。

* **感知质量与风格保真度**:

  * **FID (Fréchet Inception Distance)**: 衡量生成图像的风格分布与真实水墨画数据集的接近程度。**越低越好**。

## 4. 结论

通过联合训练，我们的**最终增强模型 (Level 3)** 预期在所有时序一致性指标（tLPIPS, Warping Error, Edge IoU）上都显著优于所有基线模型，同时保持与风格基线同样低的FID分数。这证明我们的方法在不牺牲艺术风格的前提下，成功地解决了AI生成水墨画视频中的闪烁、抖动和笔触断裂问题。
